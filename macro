<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>インタラクティブ・マクロ経済学教室</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
        }
        .chat-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 20px;
            margin-bottom: 12px;
            position: relative;
        }
        .chat-bubble-haku {
            background-color: #e2e8f0;
            align-self: flex-start;
        }
        .chat-bubble-taro {
            background-color: #cce5ff;
            align-self: flex-end;
        }
        .chat-bubble-haku::before {
            content: '🦉';
            position: absolute;
            left: -35px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
        }
        .chat-bubble-taro::after {
            content: '🧑‍🎓';
            position: absolute;
            right: -35px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
        }
        .content-card {
            background-color: white;
            border-radius: 12px;
            padding: 24px;
            margin-top: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .quiz-option {
            transition: background-color 0.3s;
        }
        .quiz-option:hover {
            background-color: #f0f4f8;
        }
        .correct {
            background-color: #d1fae5 !important;
            border-color: #10b981 !important;
        }
        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #ef4444 !important;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-blue-600">インタラクティブ・マクロ経済学教室</h1>
            <p class="mt-4 text-lg text-gray-600">フクロウ博士と一緒に、経済の仕組みを探検しよう！</p>
        </header>

        <div class="space-y-12">
            <!-- Chapter 1: Introduction -->
            <section id="chapter1">
                <h2 class="text-3xl font-bold mb-6 border-l-4 border-blue-500 pl-4">第1章：マクロ経済学の世界へようこそ！</h2>
                <div class="content-card">
                    <div class="flex flex-col space-y-4 p-4">
                        <div class="chat-bubble chat-bubble-haku">
                            やあ、エコノ太郎くん。わしはフクロウ博士じゃ。今日から一緒にマクロ経済学を学んでいこう。
                        </div>
                        <div class="chat-bubble chat-bubble-taro">
                            博士、よろしくお願いします！マクロ経済学って、なんだか難しそう…。
                        </div>
                        <div class="chat-bubble chat-bubble-haku">
                            心配いらんよ。国全体の経済、例えば景気や物価の動きを学ぶ学問じゃ。君の生活にも深く関わっておるんじゃよ。まずは、国の経済の大きさを測るモノサシ、「GDP」から見ていこう。
                        </div>
                    </div>
                </div>
                <div class="content-card">
                    <h3 class="text-xl font-bold mb-4">GDPって何だろう？</h3>
                    <p>GDPは「国内総生産」の略で、一定期間に国内で新しく生み出されたモノやサービスの「付加価値」の合計金額のことじゃ。国の経済活動の規模を示す最も重要な指標の一つなんじゃよ。</p>
                    <p class="mt-2">例えば、パン屋さんが100円で小麦粉を仕入れて、300円のパンを売ったとしよう。このとき、パン屋さんが生み出した「付加価値」は、販売価格300円から材料費100円を引いた200円になる。国中のこの付加価値をぜーんぶ足し合わせたのがGDPじゃ。</p>
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                        <h4 class="font-bold">三面等価の原則</h4>
                        <p>面白いことに、GDPは3つの違う側面から見ても同じ値になるんじゃ。</p>
                        <ul class="list-disc list-inside mt-2">
                            <li><strong>生産面 (GDP)</strong>: どれだけ付加価値が作られたか</li>
                            <li><strong>分配面 (GDI)</strong>: 生み出された価値が、給料や利益として誰に分配されたか</li>
                            <li><strong>支出面 (GDE)</strong>: 作られたものが、誰によって使われたか（消費、投資など）</li>
                        </ul>
                        <p class="mt-2">これを「三面等価の原則」と呼ぶ。どの角度から見ても経済の大きさは同じ、ということじゃな。</p>
                    </div>
                </div>
            </section>

            <!-- Chapter 2: IS-LM Model -->
            <section id="chapter2">
                <h2 class="text-3xl font-bold mb-6 border-l-4 border-green-500 pl-4">第2章：景気を動かす力 (IS-LM分析)</h2>
                <div class="content-card">
                    <div class="flex flex-col space-y-4 p-4">
                        <div class="chat-bubble chat-bubble-taro">
                            博士、ニュースでよく「政府が景気対策を…」とか「日銀が金利を…」って聞くんですけど、あれでどうして景気が変わるんですか？
                        </div>
                        <div class="chat-bubble chat-bubble-haku">
                            良い質問じゃ！それを解き明かす強力なツールが「IS-LM分析」じゃ。モノやサービス市場（財市場）と、お金の市場（貨幣市場）のバランスが、国全体の生産量（GDP）と利子率をどう決めるかを見るモデルなんじゃ。
                        </div>
                    </div>
                </div>
                <div class="content-card">
                    <h3 class="text-xl font-bold mb-4">IS-LMシミュレーター</h3>
                    <p class="mb-4">さあ、君が経済政策の大臣になったつもりで、下のスライダーを動かしてみよう。政府の支出（財政政策）や、世の中に出回るお金の量（金融政策）を変えると、経済がどう反応するか、その目で確かめるのじゃ！</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div>
                            <canvas id="is-lm-chart"></canvas>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <label for="gov-spending" class="font-bold">財政政策：政府購入 (G)</label>
                                <input type="range" id="gov-spending" min="80" max="120" value="100" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <div class="text-center font-bold text-green-600" id="gov-spending-value">100</div>
                                <p class="text-sm text-gray-600 mt-1">政府が公共事業などでお金を使うとIS曲線が動くぞ。</p>
                            </div>
                            <div>
                                <label for="money-supply" class="font-bold">金融政策：貨幣供給量 (M)</label>
                                <input type="range" id="money-supply" min="80" max="120" value="100" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <div class="text-center font-bold text-purple-600" id="money-supply-value">100</div>
                                <p class="text-sm text-gray-600 mt-1">中央銀行（日銀）がお金の量を調整するとLM曲線が動くぞ。</p>
                            </div>
                            <div id="equilibrium-info" class="p-4 bg-gray-100 rounded-lg text-center">
                                <h4 class="font-bold text-lg">均衡点</h4>
                                <p>国民所得 (Y): <span id="eq-y" class="font-bold text-xl"></span></p>
                                <p>利子率 (r): <span id="eq-r" class="font-bold text-xl"></span>%</p>
                            </div>
                            <div id="liquidity-trap-alert" class="hidden p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700">
                                <p class="font-bold">流動性の罠！</p>
                                <p>利子率がゼロ近くまで下がると、金融政策が効きにくくなるんじゃ！これを「流動性の罠」と呼ぶ。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Chapter 3: Solow-Swan Model -->
            <section id="chapter3">
                <h2 class="text-3xl font-bold mb-6 border-l-4 border-red-500 pl-4">第3章：国が豊かになる仕組み (経済成長)</h2>
                <div class="content-card">
                     <div class="flex flex-col space-y-4 p-4">
                        <div class="chat-bubble chat-bubble-taro">
                            博士、昔に比べて今の日本がとても豊かになったのはどうしてですか？国によって経済発展のスピードが違うのはなぜでしょう？
                        </div>
                        <div class="chat-bubble chat-bubble-haku">
                            それは経済の「長期的な成長」に関わる問題じゃな。その謎を解く鍵が「ソロー・スワン・モデル」じゃ。このモデルは、国がどれだけ資本（工場や機械など）を蓄積できるかが、豊かさのレベルを決める、と考えるんじゃ。
                        </div>
                    </div>
                </div>
                <div class="content-card">
                    <h3 class="text-xl font-bold mb-4">経済成長シミュレーター</h3>
                    <p class="mb-4">ここでは、国の将来を左右する重要な要素を君が決められる。人々が所得のうちどれだけ貯蓄するか、資本がどれくらいの速さで古くなるか、などを変えてみよう。経済が最終的にどこに落ち着く（定常状態）かを見てみるのじゃ。</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div>
                            <canvas id="solow-chart"></canvas>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <label for="savings-rate" class="font-bold">貯蓄率 (s)</label>
                                <input type="range" id="savings-rate" min="0.1" max="0.5" value="0.3" step="0.01" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <div class="text-center font-bold text-red-600" id="savings-rate-value">0.30</div>
                                <p class="text-sm text-gray-600 mt-1">貯蓄率が高いほど、投資に回るお金が増え、資本を増やせるぞ。</p>
                            </div>
                            <div>
                                <label for="deprecation-rate" class="font-bold">資本減耗率 (δ)</label>
                                <input type="range" id="deprecation-rate" min="0.02" max="0.1" value="0.05" step="0.005" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                <div class="text-center font-bold text-blue-600" id="deprecation-rate-value">0.050</div>
                                <p class="text-sm text-gray-600 mt-1">機械や設備が古くなるペースじゃ。この率が高いと資本が減りやすい。</p>
                            </div>
                            <div id="steady-state-info" class="p-4 bg-gray-100 rounded-lg text-center">
                                <h4 class="font-bold text-lg">定常状態</h4>
                                <p>一人当たり資本 (k): <span id="ss-k" class="font-bold text-xl"></span></p>
                                <p>一人当たり生産 (y): <span id="ss-y" class="font-bold text-xl"></span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Chapter 4: Quiz -->
            <section id="chapter4">
                <h2 class="text-3xl font-bold mb-6 border-l-4 border-yellow-500 pl-4">第4章：力だめしクイズ！</h2>
                <div class="content-card">
                    <div id="quiz-container" class="space-y-6"></div>
                    <button id="submit-quiz-btn" class="mt-6 w-full bg-yellow-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-yellow-600 transition-colors">答え合わせ</button>
                </div>
            </section>

        </div>
    </div>

<script>
// --- IS-LM Model ---
const govSpendingSlider = document.getElementById('gov-spending');
const moneySupplySlider = document.getElementById('money-supply');
const govSpendingValue = document.getElementById('gov-spending-value');
const moneySupplyValue = document.getElementById('money-supply-value');
const eqY = document.getElementById('eq-y');
const eqR = document.getElementById('eq-r');
const liquidityTrapAlert = document.getElementById('liquidity-trap-alert');

const isLmCtx = document.getElementById('is-lm-chart').getContext('2d');
let isLmChart;

// IS-LMモデルのパラメータ (講義資料の例を参考に設定)
const params = {
    c: 0.6,  // 限界消費性向
    t: 100,  // 税金
    i_bar: 150, // 基礎投資
    b: 10,  // 投資の利子弾力性
    m_bar: 100, // 実質貨幣供給量
    p: 1,    // 物価水準
    k: 0.5,  // 貨幣需要の所得弾力性
    h: 10,   // 貨幣需要の利子弾力性
    g: 100   // 政府購入
};

function drawIsLmChart() {
    const G = parseFloat(govSpendingSlider.value);
    const M = parseFloat(moneySupplySlider.value);
    params.g = G;
    params.m_bar = M;

    govSpendingValue.textContent = G.toFixed(0);
    moneySupplyValue.textContent = M.toFixed(0);

    const isCurve = [];
    const lmCurve = [];
    const yValues = Array.from({ length: 201 }, (_, i) => 100 + i * 2); // Y from 100 to 500

    // IS曲線: Y = C + I + G => r = (C_bar + I_bar + G - (1-c)Y) / b
    // 簡単化のため、Yからrを計算するのではなく、rからYを計算する
    // Y = (C_bar - cT + I_bar + G - br) / (1-c)
    const rValuesForIs = Array.from({ length: 21 }, (_, i) => i); // r from 0 to 20
    const isData = rValuesForIs.map(r => {
        const y = (params.i_bar + params.g - params.c * params.t - params.b * r) / (1 - params.c);
        return {x: y, y: r};
    });

    // LM曲線: M/P = kY - hr => r = (kY - M/P) / h
    const lmData = yValues.map(y => {
        let r = (params.k * y - params.m_bar / params.p) / params.h;
        // ゼロ金利制約
        if (r < 0) r = 0;
        return {x: y, y: r};
    });
    
    // 均衡点の計算
    // Y = (1/(1-c)) * (C_bar - cT + I_bar + G - br)
    // M/P = kY - hr
    // 連立方程式を解く
    const denominator = params.h * (1 - params.c) + params.b * params.k;
    const equilibriumY = (params.h * (params.i_bar + params.g - params.c * params.t) + params.b * (params.m_bar / params.p)) / denominator;
    let equilibriumR = (params.k * equilibriumY - (params.m_bar / params.p)) / params.h;
    
    // ゼロ金利制約
    if (equilibriumR < 0) {
        equilibriumR = 0;
        // 流動性の罠では、LM曲線が水平になるため、均衡YはIS曲線上で決まる
        // r=0をIS式のrに代入
        const equilibriumY_trap = (params.i_bar + params.g - params.c * params.t) / (1-params.c);
        eqY.textContent = equilibriumY_trap.toFixed(2);
        liquidityTrapAlert.classList.remove('hidden');
    } else {
        eqY.textContent = equilibriumY.toFixed(2);
        liquidityTrapAlert.classList.add('hidden');
    }
    
    eqR.textContent = equilibriumR.toFixed(2);

    if (isLmChart) {
        isLmChart.destroy();
    }
    isLmChart = new Chart(isLmCtx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'IS曲線 (財市場の均衡)',
                data: isData,
                borderColor: 'rgb(54, 162, 235)',
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                showLine: true,
                fill: false,
                pointRadius: 0,
            }, {
                label: 'LM曲線 (貨幣市場の均衡)',
                data: lmData,
                borderColor: 'rgb(255, 99, 132)',
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                showLine: true,
                fill: false,
                pointRadius: 0,
            }, {
                label: '均衡点',
                data: [{ x: parseFloat(eqY.textContent), y: equilibriumR }],
                borderColor: 'rgb(75, 192, 192)',
                backgroundColor: 'rgb(75, 192, 192)',
                pointRadius: 8,
                pointHoverRadius: 10,
            }]
        },
        options: {
            scales: {
                x: {
                    type: 'linear',
                    position: 'bottom',
                    title: {
                        display: true,
                        text: '国民所得 (Y)'
                    },
                    min: 200,
                    max: 500
                },
                y: {
                    title: {
                        display: true,
                        text: '利子率 (r) %'
                    },
                    min: 0,
                    max: 15
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: (Y: ${context.parsed.x.toFixed(1)}, r: ${context.parsed.y.toFixed(1)}%)`;
                        }
                    }
                }
            }
        }
    });
}

govSpendingSlider.addEventListener('input', drawIsLmChart);
moneySupplySlider.addEventListener('input', drawIsLmChart);


// --- Solow-Swan Model ---
const savingsRateSlider = document.getElementById('savings-rate');
const deprecationRateSlider = document.getElementById('deprecation-rate');
const savingsRateValue = document.getElementById('savings-rate-value');
const deprecationRateValue = document.getElementById('deprecation-rate-value');
const ssK = document.getElementById('ss-k');
const ssY = document.getElementById('ss-y');

const solowCtx = document.getElementById('solow-chart').getContext('2d');
let solowChart;

// ソロー・スワン・モデルのパラメータ
const solowParams = {
    A: 2,      // 全要素生産性
    alpha: 0.3 // 資本分配率 (生産関数 Y=A*k^alpha)
};

function drawSolowChart() {
    const s = parseFloat(savingsRateSlider.value);
    const d = parseFloat(deprecationRateSlider.value);
    // n(人口増加率)とg(技術進歩率)は簡単のため0と仮定
    const n_g_d = d;

    savingsRateValue.textContent = s.toFixed(2);
    deprecationRateValue.textContent = d.toFixed(3);

    const kValues = Array.from({ length: 101 }, (_, i) => i * 0.5); // k from 0 to 50

    // 投資曲線 s*f(k) = s*A*k^alpha
    const investmentData = kValues.map(k => ({
        x: k,
        y: s * solowParams.A * Math.pow(k, solowParams.alpha)
    }));

    // 資本減耗線 (n+g+d)k
    const deprecationData = kValues.map(k => ({
        x: k,
        y: n_g_d * k
    }));
    
    // 定常状態の計算 s*A*k^alpha = (n+g+d)k
    // k^(1-alpha) = sA / (n+g+d)
    // k = (sA / (n+g+d))^(1/(1-alpha))
    const steadyStateK = Math.pow((s * solowParams.A) / n_g_d, 1 / (1 - solowParams.alpha));
    const steadyStateY = solowParams.A * Math.pow(steadyStateK, solowParams.alpha);

    ssK.textContent = steadyStateK.toFixed(2);
    ssY.textContent = steadyStateY.toFixed(2);

    if (solowChart) {
        solowChart.destroy();
    }
    solowChart = new Chart(solowCtx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: '投資 (sf(k))',
                data: investmentData,
                borderColor: 'rgb(255, 99, 132)',
                backgroundColor: 'rgba(255, 99, 132, 0.5)',
                showLine: true,
                fill: false,
                pointRadius: 0,
            }, {
                label: '資本減耗 ((n+g+δ)k)',
                data: deprecationData,
                borderColor: 'rgb(54, 162, 235)',
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                showLine: true,
                fill: false,
                pointRadius: 0,
            }, {
                label: '定常状態',
                data: [{ x: steadyStateK, y: steadyStateY }],
                borderColor: 'rgb(75, 192, 192)',
                backgroundColor: 'rgb(75, 192, 192)',
                pointRadius: 8,
                pointHoverRadius: 10,
            }]
        },
        options: {
            scales: {
                x: {
                    type: 'linear',
                    position: 'bottom',
                    title: { display: true, text: '一人当たり資本 (k)' },
                    min: 0, max: 50
                },
                y: {
                    title: { display: true, text: '一人当たり生産/投資/減耗' },
                    min: 0, max: 5
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                             return `${context.dataset.label}: (k: ${context.parsed.x.toFixed(2)}, y: ${context.parsed.y.toFixed(2)})`;
                        }
                    }
                }
            }
        }
    });
}

savingsRateSlider.addEventListener('input', drawSolowChart);
deprecationRateSlider.addEventListener('input', drawSolowChart);


// --- Quiz ---
const quizContainer = document.getElementById('quiz-container');
const submitQuizBtn = document.getElementById('submit-quiz-btn');

const quizData = [
    {
        question: "1. 政府が公共事業を増やす（政府購入を増やす）と、IS-LMモデルでは短期的に何が起こると予測されるか？",
        options: [
            "国民所得(Y)と利子率(r)が両方とも上昇する",
            "国民所得(Y)は上昇し、利子率(r)は低下する",
            "国民所得(Y)は低下し、利子率(r)は上昇する",
            "国民所得(Y)と利子率(r)は両方とも変化しない"
        ],
        answer: 0,
        explanation: "政府購入の増加はIS曲線を右にシフトさせます。これにより、LM曲線との交点である均衡点は、より高い国民所得(Y)とより高い利子率(r)の水準に移動します。"
    },
    {
        question: "2. 中央銀行が金融緩和を行い、貨幣供給量を増やすと、IS-LMモデルでは短期的に何が起こると予測されるか？",
        options: [
            "国民所得(Y)と利子率(r)が両方とも上昇する",
            "国民所得(Y)は上昇し、利子率(r)は低下する",
            "国民所得(Y)は低下し、利子率(r)は上昇する",
            "国民所得(Y)は低下し、利子率(r)は低下する"
        ],
        answer: 1,
        explanation: "貨幣供給量の増加はLM曲線を右にシフトさせます。これにより、均衡点は、より高い国民所得(Y)とより低い利子率(r)の水準に移動します。"
    },
    {
        question: "3. ソロー・スワンの経済成長モデルにおいて、貯蓄率が上昇すると、定常状態の一人当たり資本はどうなるか？",
        options: [
            "増加する",
            "減少する",
            "変化しない",
            "モデルからは判断できない"
        ],
        answer: 0,
        explanation: "貯蓄率の上昇は、投資曲線(sf(k))を上方にシフトさせます。これにより、資本減耗線との交点である定常状態は、より高い一人当たり資本(k)の水準に移動します。つまり、国はより豊かになるポテンシャルを持つということです。"
    }
];

function buildQuiz() {
    quizData.forEach((q, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.innerHTML = `<p class="font-bold">${q.question}</p>`;
        
        const optionsDiv = document.createElement('div');
        optionsDiv.className = 'space-y-2 mt-2';
        optionsDiv.setAttribute('data-question-index', index);

        q.options.forEach((option, i) => {
            const label = document.createElement('label');
            label.className = 'block p-3 border rounded-lg cursor-pointer quiz-option';
            label.innerHTML = `
                <input type="radio" name="question${index}" value="${i}" class="mr-2">
                <span>${option}</span>
            `;
            optionsDiv.appendChild(label);
        });
        
        const explanationDiv = document.createElement('div');
        explanationDiv.id = `explanation${index}`;
        explanationDiv.className = 'hidden mt-2 p-3 bg-gray-100 rounded-lg text-sm';

        questionDiv.appendChild(optionsDiv);
        questionDiv.appendChild(explanationDiv);
        quizContainer.appendChild(questionDiv);
    });
}

submitQuizBtn.addEventListener('click', () => {
    quizData.forEach((q, index) => {
        const container = quizContainer.querySelector(`div[data-question-index="${index}"]`);
        const selected = container.querySelector(`input[name="question${index}"]:checked`);
        const labels = container.querySelectorAll('label');
        
        labels.forEach(label => {
            label.classList.remove('correct', 'incorrect');
            label.style.pointerEvents = 'none'; // Disable further clicks
        });

        if (selected) {
            const selectedAnswer = parseInt(selected.value);
            const correctLabel = labels[q.answer];
            correctLabel.classList.add('correct');
            if (selectedAnswer !== q.answer) {
                const selectedLabel = labels[selectedAnswer];
                selectedLabel.classList.add('incorrect');
            }
        } else {
            // Mark the correct answer if none is selected
            const correctLabel = labels[q.answer];
            correctLabel.classList.add('correct');
        }

        const explanationDiv = document.getElementById(`explanation${index}`);
        explanationDiv.textContent = `解説：${q.explanation}`;
        explanationDiv.classList.remove('hidden');
    });
    submitQuizBtn.textContent = 'もう一度挑戦する';
    submitQuizBtn.onclick = () => location.reload();
});


// Initial setup
window.onload = () => {
    drawIsLmChart();
    drawSolowChart();
    buildQuiz();
};

</script>
</body>
</html>
